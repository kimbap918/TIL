

## νμ΄μ¬ μ•κ³ λ¦¬μ¦ μμ—… - κΉμ΄ μ°μ„  νƒμƒ‰ 5(BOJ 24483)

<br>

## λ¬Έμ 

μ¤λλ„ μ„μ¤€μ΄λ” κΉμ΄ μ°μ„  νƒμƒ‰(DFS) μμ—… μ΅°κµλ¥Ό ν•κ³  μλ‹¤. μ•„λΉ κ°€ μμ—…ν• λ‚΄μ©μ„ ν•™μƒλ“¤μ΄ μ μ΄ν•΄ν–λ”μ§€ λ¬Έμ λ¥Ό ν†µν•΄μ„ ν™•μΈν•΄λ³΄μ.

*N*κ°μ μ •μ κ³Ό *M*κ°μ κ°„μ„ μΌλ΅ κµ¬μ„±λ λ¬΄λ°©ν–¥ κ·Έλν”„(undirected graph)κ°€ μ£Όμ–΄μ§„λ‹¤. μ •μ  λ²νΈλ” 1λ²λ¶€ν„° *N*λ²μ΄κ³  λ¨λ“  κ°„μ„ μ κ°€μ¤‘μΉλ” 1μ΄λ‹¤. μ •μ  *R*μ—μ„ μ‹μ‘ν•μ—¬ κΉμ΄ μ°μ„  νƒμƒ‰μΌλ΅ λ§λ“¤μ–΄ μ§€λ” νΈλ¦¬λ¥Ό κΉμ΄ μ°μ„  νƒμƒ‰ νΈλ¦¬λΌκ³  ν•μ. κΉμ΄ μ°μ„  νƒμƒ‰ νΈλ¦¬μ— μλ” *i*λ² λ…Έλ“μ κΉμ΄(depth)λ¥Ό *di*λΌκ³  ν•μ. μ‹μ‘ μ •μ  *R*μ κΉμ΄λ” 0μ΄κ³  λ°©λ¬Έ λμ§€ μ•λ” λ…Έλ“μ κΉμ΄λ” -1μ΄λ‹¤. μ •μ  *R*μ—μ„ μ‹μ‘ν•μ—¬ κΉμ΄ μ°μ„  νƒμƒ‰μΌλ΅ λ…Έλ“λ¥Ό λ°©λ¬Έν•  κ²½μ° *i*λ² λ…Έλ“μ λ°©λ¬Έ μμ„λ¥Ό *ti*λΌκ³  ν•μ. μ‹μ‘ μ •μ μ λ°©λ¬Έ μμ„λ” 1μ΄κ³  μ‹μ‘ μ •μ μ—μ„ λ°©λ¬Έν•  μ μ—†λ” λ…Έλ“λ” 0μ΄λ‹¤. λ¨λ“  λ…Έλ“μ— λ€ν• *di* Γ— *ti* κ°’μ ν•©μ„ κµ¬ν•΄λ³΄μ.

κΉμ΄ μ°μ„  νƒμƒ‰ μμ‚¬ μ½”λ“λ” λ‹¤μκ³Ό κ°™λ‹¤. μΈμ ‘ μ •μ μ€ **μ¤λ¦„μ°¨μ**μΌλ΅ λ°©λ¬Έν•λ‹¤.

<br>

```
dfs(V, E, R) {  # V : μ •μ  μ§‘ν•©, E : κ°„μ„  μ§‘ν•©, R : μ‹μ‘ μ •μ 
    visited[R] <- YES;  # μ‹μ‘ μ •μ  Rμ„ λ°©λ¬Έ ν–λ‹¤κ³  ν‘μ‹ν•λ‹¤.
    for each x β E(R)  # E(R) : μ •μ  Rμ μΈμ ‘ μ •μ  μ§‘ν•©.(μ •μ  λ²νΈλ¥Ό μ¤λ¦„μ°¨μμΌλ΅ λ°©λ¬Έν•λ‹¤)
        if (visited[x] = NO) then dfs(V, E, x);
}
```

<br>

## μ…λ ¥

μ²«μ§Έ μ¤„μ— μ •μ μ μ *N* (5 β‰¤ *N* β‰¤ 100,000), κ°„μ„ μ μ *M* (1 β‰¤ *M* β‰¤ 200,000), μ‹μ‘ μ •μ  *R* (1 β‰¤ *R* β‰¤ *N*)μ΄ μ£Όμ–΄μ§„λ‹¤.

λ‹¤μ *M*κ° μ¤„μ— κ°„μ„  μ •λ³΄ `*u* *v*`κ°€ μ£Όμ–΄μ§€λ©° μ •μ  *u*μ™€ μ •μ  *v*μ κ°€μ¤‘μΉ 1μΈ μ–‘λ°©ν–¥ κ°„μ„ μ„ λ‚νƒ€λ‚Έλ‹¤. (1 β‰¤ *u* < *v* β‰¤ *N*, *u* β‰  *v*) λ¨λ“  κ°„μ„ μ (*u*, *v*) μμ κ°’μ€ μ„λ΅ λ‹¤λ¥΄λ‹¤.

<br>

## μ¶λ ¥

μ²«μ§Έ μ¤„μ— λ¨λ“  λ…Έλ“μ— λ€ν• *di* Γ— *ti* κ°’μ ν•©μ„ μ¶λ ¥ν•λ‹¤.

## μμ  μ…λ ¥ 1 

```
5 5 1
1 4
1 2
2 3
2 4
3 4
```

## μμ  μ¶λ ¥ 1

```
20
```

μ •μ  1λ²μ—μ„ μ •μ  2λ²μ„ λ°©λ¬Έν•λ‹¤. μ •μ  2λ²μ—μ„ μ •μ  3λ²μ„ λ°©λ¬Έν•λ‹¤. μ •μ  3λ²μ—μ„ μ •μ  4λ²μ„ λ°©λ¬Έν•λ‹¤. μ •μ  5λ²μ€ μ •μ  1λ²μ—μ„ λ°©λ¬Έν•  μ μ—†λ‹¤. λ”°λΌμ„, *ti* κ°’μ€ 1λ² μ •μ λ¶€ν„° 1, 2, 3, 4, 0μ΄λ‹¤.

κΉμ΄ μ°μ„  νƒμƒ‰ νΈλ¦¬λ” 1, 2, 3, 4λ² λ…Έλ“λ΅ κµ¬μ„±λλ‹¤. 1λ² λ…Έλ“κ°€ λ£¨νΈμ΄λ‹¤. 1λ² λ…Έλ“μ μμ‹μ€ 2λ² λ…Έλ“μ΄λ‹¤. 2λ² λ…Έλ“μ μμ‹μ€ 3λ² λ…Έλ“μ΄λ‹¤. 3λ² λ…Έλ“μ μμ‹μ€ 4λ² λ…Έλ“μ΄λ‹¤. 5λ² λ…Έλ“λ” 1λ² λ…Έλ“μ—μ„ λ°©λ¬Έ λ  μ μ—†λ‹¤. λ”°λΌμ„, *di*κ°’μ€ 1λ² μ •μ λ¶€ν„° 0, 1, 2, 3, -1μ΄λ‹¤.

*ti* Γ— *di* κ°’μ ν•©μ€ 1Γ—0 + 2Γ—1 + 3Γ—2 + 4Γ—3 + 0Γ—(-1) = 20μ΄λ‹¤.

<br>

## π“ ν’€μ–΄λ³΄κΈ° 

μ •μ μ μ N, κ°„μ„ μ μ M, μ‹μ‘ μ •μ  Rμ„ μ…λ ¥λ°›λ”λ‹¤.

N+1λ§νΌ λΉ λ¦¬μ¤νΈλ¥Ό graphμ— μ €μ¥ν•λ‹¤. 

λ°©λ¬Έλμ§€ μ•μ€ λ…Έλ“μ κΉμ΄ -1μ„ N+1λ§νΌ visitedμ— μ €μ¥ν•λ‹¤.

tμ—λ” λ°©λ¬Έ μ •μ μ„ λ‹΄λ” λ¦¬μ¤νΈλ‹¤. cntλ” λ°©λ¬Έ μ •μ μ„ μ¦κ°€μ‹ν‚¤λ©° μ €μ¥ν•κ³ , ansλ” λ…Έλ“μ™€ λ°©λ¬Έμ •μ μ μΉ΄μ΄νΈλ¥Ό κ³±ν•΄μ„ λ„μ ν•©μ„ ν•  λ³€μλ‹¤.

``` python
import sys
input = sys.stdin.readline
sys.setrecursionlimit(10**6)

N, M, R = map(int, input().split())
graph = [[] for _ in range(N+1)]
visited = [-1] * (N+1)
t = [0] * (N+1) 
cnt = 1
ans = 0
```

<br>

Mλ§νΌ λ°λ³µν•λ©΄μ„ κ°„μ„  μ •λ³΄ u, vλ¥Ό μ…λ ¥λ°›λ”λ‹¤.

μ…λ ¥λ°›μ€ κ°„μ„ μ μ •λ³΄λ¥Ό graphμ— μ €μ¥ν•κ³  κ·Έλν”„ λ‚΄μ κ°’μ„ μ¤λ¦„μ°¨μ μ •λ ¬ν•λ‹¤.

κ·Έλ¦¬κ³  DFSλ¥Ό μν–‰ν•λ‹¤. 

``` python
for i in range(M):
    u, v = map(int, input().split())
    graph[u].append(v)
    graph[v].append(u)

for num in graph:
    num.sort()
    
DFS(R, 0)
```

 <br>

DFSλ¥Ό μ •μν•λ‹¤.

tμ μ‹μ‘μ •μ  μΈλ±μ¤μ— cntκ°’μ„ μ €μ¥ν•λ‹¤.

visitedμ μ‹μ‘μ •μ  μΈλ±μ¤μ— κΉμ΄λ¥Ό μ €μ¥ν•λ‹¤.

graphμ μ‹μ‘μ •μ  μΈλ±μ¤λ¶€ν„° graphλ‚΄μ μ”μ†λ¥Ό νƒμƒ‰ν•λ©΄μ„ visited[i]κ°€ -1μ΄λΌλ©΄ cntλ¥Ό 1 μ¦κ°€μ‹ν‚¤κ³  κΉμ΄λ¥Ό 1μ¦κ°€μ‹μΌμ¤€λ‹¤.

κ·Έλ¦¬κ³  iκ°’κ³Ό μ¦κ°€μ‹ν‚¨ κΉμ΄κ°’μ„ μΈμλ΅ λ„£μ–΄ DFSν•¨μλ¥Ό μ¬κ·€νΈμ¶ν•λ‹¤.

``` python
def DFS(r, depth):
    global cnt
    t[r] = cnt
    visited[r] = depth

    for i in graph[r]:
        if visited[i] == -1:
            cnt += 1
            DFS(i, depth+1)
```

<br>

μΈλ±μ¤μ 0λ²μ§Έ μ”μ†λ” μ‚¬μ©ν•μ§€ μ•κΈ° λ•λ¬Έμ— 1λ¶€ν„° N+1κΉμ§€ t[i]μ™€ visited[i]λ¥Ό κ³±ν• κ°’μ„ ansμ— λ„μ μ‹ν‚¤κ³  ansλ¥Ό μ¶λ ¥ν•λ‹¤.

``` python
for i in range(1, N+1): 
    ans += t[i] * visited[i]

print(ans)
```

<br>

#### μ „μ²΄μ½”λ“

```python
import sys
input = sys.stdin.readline
sys.setrecursionlimit(10**6)

N, M, R = map(int, input().split())
graph = [[] for _ in range(N+1)]
visited = [-1] * (N+1)
t = [0] * (N+1) 
cnt = 1
ans = 0

def DFS(r, depth):
    global cnt
    t[r] = cnt
    visited[r] = depth

    for i in graph[r]:
        if visited[i] == -1:
            cnt += 1
            DFS(i, depth+1)

for i in range(M):
    u, v = map(int, input().split())
    graph[u].append(v)
    graph[v].append(u)

for num in graph:
    num.sort()
    
DFS(R, 0)

for i in range(1, N+1): 
    ans += t[i] * visited[i]

print(ans)
```

