

## νμ΄μ¬ μ•κ³ λ¦¬μ¦ μμ—… - λ„λΉ„ μ°μ„  νƒμƒ‰ 1(BOJ 24444)

<br>

## λ¬Έμ 

μ¤λλ„ μ„μ¤€μ΄λ” λ„λΉ„ μ°μ„  νƒμƒ‰(BFS) μμ—… μ΅°κµλ¥Ό ν•κ³  μλ‹¤. μ•„λΉ κ°€ μμ—…ν• λ‚΄μ©μ„ ν•™μƒλ“¤μ΄ μ μ΄ν•΄ν–λ”μ§€ λ¬Έμ λ¥Ό ν†µν•΄μ„ ν™•μΈν•΄λ³΄μ.

*N*κ°μ μ •μ κ³Ό *M*κ°μ κ°„μ„ μΌλ΅ κµ¬μ„±λ λ¬΄λ°©ν–¥ κ·Έλν”„(undirected graph)κ°€ μ£Όμ–΄μ§„λ‹¤. μ •μ  λ²νΈλ” 1λ²λ¶€ν„° *N*λ²μ΄κ³  λ¨λ“  κ°„μ„ μ κ°€μ¤‘μΉλ” 1μ΄λ‹¤. μ •μ  *R*μ—μ„ μ‹μ‘ν•μ—¬ λ„λΉ„ μ°μ„  νƒμƒ‰μΌλ΅ λ…Έλ“λ¥Ό λ°©λ¬Έν•  κ²½μ° λ…Έλ“μ λ°©λ¬Έ μμ„λ¥Ό μ¶λ ¥ν•μ.

λ„λΉ„ μ°μ„  νƒμƒ‰ μμ‚¬ μ½”λ“λ” λ‹¤μκ³Ό κ°™λ‹¤. μΈμ ‘ μ •μ μ€ **μ¤λ¦„μ°¨μ**μΌλ΅ λ°©λ¬Έν•λ‹¤.

```
bfs(V, E, R) {  # V : μ •μ  μ§‘ν•©, E : κ°„μ„  μ§‘ν•©, R : μ‹μ‘ μ •μ 
    for each v β V - {R}
        visited[v] <- NO;
    visited[R] <- YES;  # μ‹μ‘ μ •μ  Rμ„ λ°©λ¬Έ ν–λ‹¤κ³  ν‘μ‹ν•λ‹¤.
    enqueue(Q, R);  # ν λ§¨ λ’¤μ— μ‹μ‘ μ •μ  Rμ„ μ¶”κ°€ν•λ‹¤.
    while (Q β‰  β…) {
        u <- dequeue(Q);  # ν λ§¨ μ•μ½μ μ”μ†λ¥Ό μ‚­μ ν•λ‹¤.
        for each v β E(u)  # E(u) : μ •μ  uμ μΈμ ‘ μ •μ  μ§‘ν•©.(μ •μ  λ²νΈλ¥Ό μ¤λ¦„μ°¨μμΌλ΅ λ°©λ¬Έν•λ‹¤)
            if (visited[v] = NO) then {
                visited[v] <- YES;  # μ •μ  vλ¥Ό λ°©λ¬Έ ν–λ‹¤κ³  ν‘μ‹ν•λ‹¤.
                enqueue(Q, v);  # ν λ§¨ λ’¤μ— μ •μ  vλ¥Ό μ¶”κ°€ν•λ‹¤.
            }
    }
}
```

<br>

## μ…λ ¥

μ²«μ§Έ μ¤„μ— μ •μ μ μ *N* (5 β‰¤ *N* β‰¤ 100,000), κ°„μ„ μ μ *M* (1 β‰¤ *M* β‰¤ 200,000), μ‹μ‘ μ •μ  *R* (1 β‰¤ *R* β‰¤ *N*)μ΄ μ£Όμ–΄μ§„λ‹¤.

λ‹¤μ *M*κ° μ¤„μ— κ°„μ„  μ •λ³΄ `*u* *v*`κ°€ μ£Όμ–΄μ§€λ©° μ •μ  *u*μ™€ μ •μ  *v*μ κ°€μ¤‘μΉ 1μΈ μ–‘λ°©ν–¥ κ°„μ„ μ„ λ‚νƒ€λ‚Έλ‹¤. (1 β‰¤ *u* < *v* β‰¤ *N*, *u* β‰  *v*) λ¨λ“  κ°„μ„ μ (*u*, *v*) μμ κ°’μ€ μ„λ΅ λ‹¤λ¥΄λ‹¤.

<br>

## μ¶λ ¥

μ²«μ§Έ μ¤„λ¶€ν„° *N*κ°μ μ¤„μ— μ •μλ¥Ό ν• κ°μ”© μ¶λ ¥ν•λ‹¤. *i*λ²μ§Έ μ¤„μ—λ” μ •μ  *i*μ λ°©λ¬Έ μμ„λ¥Ό μ¶λ ¥ν•λ‹¤. μ‹μ‘ μ •μ μ λ°©λ¬Έ μμ„λ” 1μ΄λ‹¤. μ‹μ‘ μ •μ μ—μ„ λ°©λ¬Έν•  μ μ—†λ” κ²½μ° 0μ„ μ¶λ ¥ν•λ‹¤.



<br>

## π“ ν’€μ–΄λ³΄κΈ° 

μ΄λ² λ¬Έμ λ„ μµλ€ν• μμ‚¬μ½”λ“μ™€ λΉ„μ·ν•κ² ν’€μ–΄λ΄¤λ‹¤.

<br>

μ •μ μ μ N, κ°„μ„ μ μ M, μ‹μ‘ μ •μ  Rμ„ μ…λ ¥λ°›λ”λ‹¤.

μ •μ μ μ§‘ν•© E μ— N+1λ§νΌ λΉ κ³µκ°„μ„ λ§λ“¤μ–΄ μ €μ¥ν•΄λ‘”λ‹¤. μ—¬κΈ°μ—λ” κ°„μ„ μ μ •λ³΄ u, vκ°€ μ €μ¥λλ‹¤.

λ°©λ¬Έ μ—¬λ¶€λ¥Ό ν™•μΈν•κΈ° μ„ν•΄ visitedμ— [0]μ„ N+1λ§νΌ μƒμ„±ν•΄μ„ μ €μ¥ν•κ³  cntμ— 1μ„ μ €μ¥ν•΄λ‘”λ‹¤. 

``` python
import sys
from collections import deque
input = sys.stdin.readline
N, M, R = map(int, input().split())
E = [[] for _ in range(N+1)]
visited = [0] * (N+1)
cnt = 1
```

<br>

Mλ§νΌ λ°λ³µν•λ©΄μ„ κ°„μ„ μ •λ³΄ u,vλ¥Ό μ…λ ¥λ°›κ³  Eμ— μ €μ¥ν•΄λ‘”λ‹¤.

```python
for i in range(M):
    u, v = map(int, input().split())
    E[u].append(v)
    E[v].append(u)
```

<br>

dfsλ¥Ό κµ¬ν„ν•λ‹¤.

μ—¬κΈ°μ„ Rμ€ μ‹μ‘ μ •μ μ΄λ‹¤. dequeλ¥Ό λ§λ“¤μ–΄ μ‹μ‘μ •μ  Rμ„ μ €μ¥ν•΄λ‘”λ‹¤.

visited[R] μ€ μ‹μ‘μ μ΄λ―€λ΅ μ—¬κΈ°μ— 1μ„ μ €μ¥ν•΄λ‘”λ‹¤.

Qμ κ°€μ¥ μ™Όμ½μ κ°’μ„ λΉΌλ‚΄κ³ , uμ— μ €μ¥ν•΄λ‘”λ‹¤.

κ°„μ„ μ •λ³΄κ°€ λ‹΄κΈ΄ Eλ¥Ό μ¤λ¦„μ°¨μμΌλ΅ μ •λ ¬ν•κ³  E[u]λ¥Ό μνν•λ©΄μ„ λ°©λ¬Έμ΄ λμ§€ μ•μ€κ³³μ„ νƒμƒ‰ν•λ©΄ cntλ¥Ό μ¬λ¦¬λ©΄μ„ ν•΄λ‹Ή κ°’μ„ visitedμ— μ €μ¥ν•κ³ , Qμ—λ„ μνμ¤‘μΈ E[u]μ κ°’ iλ¥Ό μ €μ¥ν•λ‹¤.

```python
def bfs(E, R, visited):
    global cnt
    # μ‹μ‘μ§€μ μ΄ λ“¤μ–΄κ° 
    Q = deque([R])
    # μ‹μ‘ μ •μ  λ°©λ¬Έ ν‘μ‹
    visited[R] = 1
    while Q:
        u = Q.popleft()
        E[u].sort()
        for i in E[u]:
            if visited[i] == 0:
                cnt += 1
                visited[i] = cnt
                Q.append(i)

bfs(E, R, visited)
```

<br>

visitedμ 1λ²μ§Έ μΈλ±μ¤λ¶€ν„° μ¶λ ¥ν•λ‹¤.

```python
for i in visited[1:]:
    print(i)
```

<br>

#### μ „μ²΄μ½”λ“

``` python
import sys
from collections import deque
input = sys.stdin.readline
N, M, R = map(int, input().split())
E = [[] for _ in range(N+1)]
visited = [0] * (N+1)
cnt = 1

for i in range(M):
    u, v = map(int, input().split())
    E[u].append(v)
    E[v].append(u)


def bfs(E, R, visited):
    global cnt
    # μ‹μ‘μ§€μ μ΄ λ“¤μ–΄κ° 
    Q = deque([R])
    # μ‹μ‘ μ •μ  λ°©λ¬Έ ν‘μ‹
    visited[R] = 1
    while Q:
        u = Q.popleft()
        E[u].sort()
        for i in E[u]:
            if visited[i] == 0:
                cnt += 1
                visited[i] = cnt
                Q.append(i)

bfs(E, R, visited)

for i in visited[1:]:
    print(i)
```

